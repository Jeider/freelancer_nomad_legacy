[Mission]
npc_ship_file = missions\m03\npcships.ini

[NPC]
nickname = npc_nnvoice
affiliation = li_n_grp
npc_ship_arch = nnvoice_shiparch
space_costume = , robot_body_E
individual_name = 089999
voice = nn_mod

[MsnShip]
nickname = nag_voice
NPC = npc_nnvoice
jumper = false
label = the_nnvoice
position = 0,-50000,0

;--------------------------------

[ObjList]
nickname = force_stop
Idle = no_params

[ObjList]
nickname = unform
BreakFormation = no_params

[ObjList]
nickname = unform_n_stop
BreakFormation = no_params
Idle = no_params

[ObjList]
nickname = follow_player
SetPriority = ALWAYS_EXECUTE
follow = Player



;--------------------------



;;;gen msn ships

{{ objects_definitions }}

;-------------------------------------
;waypoints

{{ nn_objectives_list }}

;GENERIC
;ALLY
;CAPITAL

;GUNSHIP
[NPC]
nickname = npc_rh_gunship
affiliation = rh_grp
npc_ship_arch = ms3_rh_gunship

[MsnShip]
nickname = gunship_1
NPC = npc_rh_gunship
label = friend
label = rh_capital
label = gunboat_fleet
random_name = true

[MsnShip]
nickname = gunship_2
NPC = npc_rh_gunship
label = friend
label = rh_capital
label = gunboat_fleet
random_name = true

[MsnShip]
nickname = gunship_3
NPC = npc_rh_gunship
label = friend
label = rh_capital
label = gunboat_fleet
random_name = true

[MsnShip]
nickname = gunship_4
NPC = npc_rh_gunship
label = friend
label = rh_capital
label = gunboat_fleet
random_name = true

;CRUISER

[NPC]
nickname = npc_rh_cruiser
affiliation = rh_grp
npc_ship_arch = ms3_rh_cruiser

[MsnShip]
nickname = cruiser_1
NPC = npc_rh_cruiser
label = friend
label = rh_capital
label = cruiser_fleet
random_name = true

[MsnShip]
nickname = cruiser_2
NPC = npc_rh_cruiser
label = friend
label = rh_capital
label = cruiser_fleet
random_name = true

;BATTLESHIP

[NPC]
nickname = npc_rh_battleship
affiliation = rh_grp
npc_ship_arch = ms3_rh_battleship
individual_name = 093204

[MsnShip]
nickname = battleship_1
NPC = npc_rh_battleship
label = friend
label = rh_capital
label = battleship

;FIGHTERS

;CAPITALS DEFEND WING

[MsnFormation]
nickname = fleet_wing
formation = fighter_basic
{{ fleet_fighter.formation_members() }}

;ASSAULT ASSISTANCE WING

[MsnFormation]
nickname = assist_wing
formation = fighter_basic
{{ assist.formation_members() }}

;ENEMY

;MAIN FIGHTERS

;FIRST TROUBLE


;; define defenders

[NPC]
nickname = npc_evil_rh_elite
affiliation = fc_b_grp
npc_ship_arch = ms3_EVIL_rh_elite
voice = pilot_f_mil_m02

[NPC]
nickname = npc_evil_rh_fighter
affiliation = fc_b_grp
npc_ship_arch = ms3_EVIL_rh_fighter
voice = pilot_f_leg_m01

;ESCAPERS

[MsnFormation]
nickname = escapers_1
formation = fighter_basic
{{ escaper1.formation_members() }}

[MsnFormation]
nickname = escapers_2
formation = fighter_basic
{{ escaper2.formation_members() }}

[MsnFormation]
nickname = escapers_3
formation = fighter_basic
{{ escaper3.formation_members() }}

[MsnFormation]
nickname = escapers_4
formation = fighter_basic
{{ escaper4.formation_members() }}

;DEIDRICH AND HELPERS

;deidrich
[NPC]
nickname = npc_deidrich
affiliation = fc_uk_grp
npc_ship_arch = ms3_deidrich
individual_name = 093203

[MsnShip]
nickname = deidrich
NPC = npc_deidrich
label = enemy
label = deidrich_the
label = deidrich_team

[NPC]
nickname = npc_evil_rh_freighter
affiliation = fc_b_grp
npc_ship_arch = ms3_EVIL_rh_freighter

[MsnShip]
nickname = evil_freighter
NPC = npc_evil_rh_freighter
jumper = false
label = enemy
label = deidrich_team
random_name = true

[MsnShip]
nickname = evil_fighter_1
NPC = npc_evil_rh_elite
jumper = false
label = enemy
label = deidrich_team
label = deidrich_defend
random_name = true

[MsnShip]
nickname = evil_fighter_2
NPC = npc_evil_rh_elite
jumper = false
label = enemy
label = deidrich_team
label = deidrich_defend
random_name = true

[MsnShip]
nickname = evil_fighter_3
NPC = npc_evil_rh_elite
jumper = false
label = enemy
label = deidrich_team
label = deidrich_defend
random_name = true

[MsnFormation]
nickname = evil_wing
formation = fighter_basic
ship = {{ evil_freighter.member() }}
ship = {{ deidrich.member() }}
{{ evil_fighter.formation_members() }}

;MSN SOLARS

;WEAPON PLATFORMS

[MsnSolar]
nickname = {{ kgb.name }}
string_id = 093214
faction = co_grp
system = rh_kgb
position = {{ kgb.pos }}
orientation = {{ kgb.orient }}
archetype = kgb_core
loadout = trading_outpost_core_shieldgen
label = kgb_core
radius = 0

[MsnSolar]
nickname = {{ dock1.name }}
system = rh_kgb
position = {{ dock1.pos }}
orientation = {{ dock1.orient }}
archetype = freeport7
label = kgb_core
radius = 0

[MsnSolar]
nickname = {{ dock2.name }}
system = rh_kgb
position = {{ dock2.pos }}
orientation = {{ dock2.orient }}
archetype = freeport7
label = kgb_core
radius = 0

[MsnSolar]
nickname = {{ gen1_laser.name }}
string_id = 093221
faction = co_grp
system = rh_kgb
position = {{ gen1_laser.pos }}
orientation = {{ gen1_laser.orient }}
archetype = kgb_lasergen
loadout = trading_outpost_core_lasergen
label = lasergen
radius = 0
base = sig8_01_base

[MsnSolar]
nickname = {{ gen1.name }}
string_id = 093222
faction = co_grp
system = rh_kgb
position = {{ gen1.pos }}
orientation = {{ gen1.orient }}
archetype = dyson_generator
loadout = dyson_generator_msn3
label = generator
radius = 0
base = sig8_01_base


[MsnSolar]
nickname = {{ gen2_laser.name }}
string_id = 093221
faction = co_grp
system = rh_kgb
position = {{ gen2_laser.pos }}
orientation = {{ gen2_laser.orient }}
archetype = kgb_lasergen
loadout = trading_outpost_core_lasergen
label = lasergen
radius = 0
base = sig8_01_base


[MsnSolar]
nickname = {{ gen2.name }}
string_id = 093222
faction = co_grp
system = rh_kgb
position = {{ gen2.pos }}
orientation = {{ gen2.orient }}
archetype = dyson_generator
loadout = dyson_generator_msn3
label = generator
radius = 0
base = sig8_01_base

[Trigger]
nickname = KGB_SHIELD_ZONE
Cnd_DistShip = inside, Player, {{ kgb.name }}, 4000
Act_PObjIdle = no_params
Act_ActTrig = KGB_SHIELD_autostop
Act_ActTrig = KGB_SHIELD_autostop_DISABLE
Act_ActTRig = KGB_SHIELD_death_zone

[Trigger]
nickname = KGB_SHIELD_autostop_DISABLE
Cnd_DistShip = outside, Player, {{ kgb.name }}, 4000
Act_ActTrig = KGB_SHIELD_ZONE
Act_DeActTrig = KGB_SHIELD_autostop
Act_DeActTrig = KGB_SHIELD_autostop_DISABLE
Act_DeActTrig = KGB_SHIELD_death_zone

[Trigger]
nickname = KGB_SHIELD_autostop
Cnd_Timer = 1
Act_PObjIdle = no_params
repeatable = true

[Trigger]
nickname = KGB_SHIELD_death_zone
Cnd_DistShip = inside, Player, {{ kgb.name }}, 3500
Act_Destroy = Player

[Trigger]
nickname = KGB_SHIELD_ZONE_turn_off
Cnd_True = no_params
Act_DeActTrig = KGB_SHIELD_ZONE
Act_DeActTrig = KGB_SHIELD_autostop
Act_DeActTrig = KGB_SHIELD_autostop_DISABLE
Act_DeActTrig = KGB_SHIELD_death_zone

;OBJECTIVES LIST

[ObjList]
nickname = starke_follow_player
SetPriority = ALWAYS_EXECUTE
FollowPlayer = fighter_basic, {{ wilham.member() }}, {{ hassler.member() }}

[ObjList]
nickname = punishers_follow_player
SetPriority = ALWAYS_EXECUTE
FollowPlayer = fighter_basic, {{ hassler.member() }}, {{ punisher.member_list() }}

[ObjList]
nickname = force_follow_player
SetPriority = NORMAL
follow = Player, 150, -70, 50, -100, 50000

[Trigger]
nickname = remove_starke_formation
Cnd_True = no_params
Act_GiveObjList = Player, unform
Act_GiveObjList = Player, force_stop
Act_GiveObjList = wilham, unform
Act_GiveObjList = hassler, unform

[Trigger]
nickname = remove_punishers_formation
Cnd_True = no_params
Act_GiveObjList = Player, unform
Act_GiveObjList = Player, force_stop
Act_GiveObjList = hassler, unform
Act_GiveObjList = punisher2, unform
Act_GiveObjList = punisher3, unform
Act_GiveObjList = punisher4, unform
Act_GiveObjList = punisher5, unform

[ObjList]
nickname = goto_sp01_jumphole
SetPriority = ALWAYS_EXECUTE
GotoVec = goto_cruise, {{ sig8_to_kgb.pos }}, 500, true

[ObjList]
nickname = goto_generator2
SetPriority = ALWAYS_EXECUTE
GotoVec = goto_cruise, {{ gen2.pos }}, 500, true

[ObjList]
nickname = regroup_assistance
MakeNewFormation = fighter_basic, {{ assist.member_list }}

[ObjList]
nickname = basic_goto_freeport
Avoidance = false
{{ kgb.goto_vec('goto_cruise', 1500) }}

[ObjList]
nickname = gunship_1_goto
Avoidance = false
{{ gb1_goto.goto_vec('goto_cruise', 50) }}
{{ gb1_attack.goto_vec('goto_no_cruise', 50) }}

[ObjList]
nickname = gunship_2_goto
Avoidance = false
{{ gb2_goto.goto_vec('goto_cruise', 50) }}
{{ gb2_attack.goto_vec('goto_no_cruise', 50) }}

[ObjList]
nickname = gunship_3_goto
Avoidance = false
{{ gb3_goto.goto_vec('goto_cruise', 50) }}
{{ gb3_attack.goto_vec('goto_no_cruise', 50) }}

[ObjList]
nickname = gunship_4_goto
Avoidance = false
{{ gb4_goto.goto_vec('goto_cruise', 50) }}
{{ gb4_attack.goto_vec('goto_no_cruise', 50) }}

[ObjList]
nickname = cruiser_1_goto
Avoidance = false
{{ cr1_goto.goto_vec('goto_cruise', 50) }}
{{ cr1_attack.goto_vec('goto_no_cruise', 50) }}

[ObjList]
nickname = cruiser_2_goto
Avoidance = false
{{ cr2_goto.goto_vec('goto_cruise', 50) }}
{{ cr2_attack.goto_vec('goto_no_cruise', 50) }}

[ObjList]
nickname = battleship_1_goto
Avoidance = false
{{ bsh_goto.goto_vec('goto_cruise', 50) }}
{{ bsh_attack.goto_vec('goto_no_cruise', 50) }}

[ObjList]
nickname = escape_point_1
{{ escaper1_goto.goto_vec('goto_cruise', 500) }}

[ObjList]
nickname = escape_point_2
{{ escaper2_goto.goto_vec('goto_cruise', 500) }}

[ObjList]
nickname = escape_point_3
{{ escaper3_goto.goto_vec('goto_cruise', 500) }}

[ObjList]
nickname = escape_point_4
{{ escaper4_goto.goto_vec('goto_cruise', 500) }}

[ObjList]
nickname = deidrich_point_1
GotoVec = goto_cruise, {{ deidrich8.pos }}, 100, true

[ObjList]
nickname = deidrich_point_2
SetPriority = ALWAYS_EXECUTE
GotoVec = goto_cruise, {{ kgb_to_rh_mnh.pos }}, 1000, true

[ObjList]
nickname = fight_with_trent
SetPriority = ALWAYS_EXECUTE
BreakFormation = no_params
GotoShip = goto_no_cruise, Player, 1000, true

;GENERAL TRIGGERS

[Trigger]
nickname = general_triggers
Cnd_True = no_params
Act_ActTrig = get_friendship
Act_Invulnerable = {{ hassler.member() }}, true
{{ punisher.invulnerable(true) }}
{{ assist.invulnerable(true) }}

[Trigger]
nickname = get_friendship
Cnd_True = no_params
Act_SetVibeLblToShip = friend, Player, REP_FRIEND_MAXIMUM
Act_SetVibeShipToLbl = Player, friend, REP_FRIEND_MAXIMUM

[Trigger]
nickname = init_ms3
Cnd_True = no_params
InitState = ACTIVE
Act_ActTrig = init_objective
Act_ActTrig = ms3_create_vendor

Act_ActTrig = first_message_not_in_space
Act_ActTrig = first_message_in_space
Act_ActTrig = first_message_on_planet
Act_ActTrig = vendorbase_open_forever


[Trigger]
nickname = first_message_not_in_space
Cnd_InSpace = false
Act_DeActTrig = first_message_in_space

[Trigger]
nickname = first_message_in_space
Cnd_InSpace = true
Act_ActTrig = first_message_init_message
Act_DeActTrig = first_message_on_planet

[Trigger]
nickname = first_message_on_planet
Cnd_LaunchComplete = Player
Act_ActTrig = first_message_wait_and_call

[Trigger]
nickname = first_message_wait_and_call
Cnd_Timer = 1
Act_ActTrig = first_message_init_message

[Trigger]
nickname = first_message_init_message
Cnd_True = no_params
Act_ActTrig = vendor_message

[Trigger]
nickname = vendorbase_open_forever
Cnd_True = no_params
repeatable = true
Act_SetVibeOfferBaseHack = {{ starke.name }}

[Trigger]
nickname = vendor_message
Cnd_Timer = 2
;Vendor: Greetings, Freelancer
Act_EtherComm = echo_m03, 093501, Player, DX_M03_0000_wilhelm, -1, rh_wilham_head, rh_wilham_body


[Trigger]
nickname = init_objective
Cnd_True = no_params
{{ nn_meet_vendor.set_as_path() }}

[Trigger]
nickname = ms3_create_vendor
Cnd_LocEnter = Bar, {{ starke.base }}
Act_AddRTC = missions\m03\vendor_msn.ini
Act_ActTrig = ms3_do_accept
repeatable = true

[Trigger]
nickname = ms3_do_accept
Cnd_MsnResponse = accept
Act_RemoveRTC = missions\m03\vendor_msn.ini
Act_PlayerCanDock = false
Act_PlayerCanTradelane = false
Act_RandomPop = false
Act_DeActTrig = ms3_create_vendor
Act_ActTrig = starke_in_space
Act_ActTrig = starke_launch_complete
{{ nn_launch.set() }}

Act_SetTitle = 093301
Act_SetOffer = 093302

Act_DeActTrig = first_message_in_space
Act_DeActTrig = first_message_not_in_space
Act_DeActTrig = first_message_on_planet
Act_DeActTrig = vendorbase_open_forever

Act_ActTrig = MSN_REP_BEFORE

;debug ship
;Act_SetShipAndLoadout = rh_fighter, lod_m03_player

;LAUNCHED


[Trigger]
nickname = starke_in_space
Cnd_InSpace = true
Act_SpawnShip = wilham, no_ol, {{ launch_wilham.pos_orient }}
Act_SpawnShip = hassler, no_ol, {{ launch_hassler.pos_orient }}
{{ nag.nag_voice }}
Act_EnableManeuver = formation, false

[Trigger]
nickname = starke_launch_complete
Cnd_LaunchComplete = Player
Act_GiveObjList = Player, starke_follow_player
Act_SetNNState = HIDDEN, true
Act_ActTrig = starke_greetings_dialog
Act_ActTrig = general_triggers
Act_ActTrig = draw_sig8_fleet

[Trigger]
nickname = starke_greetings_dialog
Cnd_Timer = 2
;Hassler: We need to go
Act_EtherComm = echo_m03, 093560, Player, DX_M03_1010_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman

{{ nn_goto_fleet.set() }}
Act_MarkObj = wilham, 1
Act_MarkObj = hassler, 1
Act_ActTrig = starke_start_msg_done
Act_ActTrig = far_around_sig8_fleet


[Trigger]
nickname = draw_sig8_fleet
Cnd_True = no_params
Act_SpawnShip = battleship_1, no_ol, {{ m3_init_bship.pos_orient }}
Act_ActTrig = get_friendship
Act_ActTrig = draw_sig8_cruisers

[Trigger]
nickname = draw_sig8_cruisers
Cnd_DistVec = inside, Player, {{ m3_init_point.pos }}, 10000
Act_SpawnShip = cruiser_1, no_ol, {{ m3_init_cruiser1.pos_orient }}
Act_SpawnShip = cruiser_2, no_ol, {{ m3_init_cruiser2.pos_orient }}
Act_ActTrig = get_friendship
Act_ActTrig = draw_sig8_gunboats

[Trigger]
nickname = draw_sig8_gunboats
Cnd_DistVec = inside, Player, {{ m3_init_point.pos }}, 7000
Act_SpawnShip = gunship_1, no_ol, {{ m3_init_gb1.pos_orient }}
Act_SpawnShip = gunship_2, no_ol, {{ m3_init_gb2.pos_orient }}
Act_SpawnShip = gunship_3, no_ol, {{ m3_init_gb3.pos_orient }}
Act_SpawnShip = gunship_4, no_ol, {{ m3_init_gb4.pos_orient }}
Act_ActTrig = get_friendship
Act_ActTrig = draw_sig8_fighters

[Trigger]
nickname = draw_sig8_fighters
Cnd_DistVec = inside, Player, {{ m3_init_point.pos }}, 5000
Act_SpawnShip = {{ punisher.member(1) }}, no_ol, {{ m3_init_ship1.pos_orient }}
Act_SpawnShip = {{ punisher.member(2) }}, no_ol, {{ m3_init_ship2.pos_orient }}
Act_SpawnShip = {{ punisher.member(3) }}, no_ol, {{ m3_init_ship3.pos_orient }}
Act_SpawnShip = {{ punisher.member(4) }}, no_ol, {{ m3_init_ship4.pos_orient }}
Act_SpawnFormation = fleet_wing, {{ m3_init_fleet_wing.pos_orient }}
Act_SpawnFormation = assist_wing, {{ m3_init_assist_wing.pos_orient }}
Act_ActTrig = get_friendship

[Trigger]
nickname = far_around_sig8_fleet
Cnd_DistVec = inside, Player, {{ m3_init_point.pos }}, 15000
;Wilham: Briefing started
Act_EtherComm = echo_m03, 093561, Player, DX_M03_1020_wilham, -1, rh_wilham_head, rh_wilham_body, comm_rh_wilham

;Hassler: Let me listen
Act_EtherComm = echo_m03, 093562, Player, DX_M03_1030_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman

;Wilham: Done
Act_EtherComm = echo_m03, 093563, Player, DX_M03_1040_wilham, -1, rh_wilham_head, rh_wilham_body, comm_rh_wilham

Act_ActTrig = far_around_sig8_fleet_dialog_done

[Trigger]
nickname = far_around_sig8_fleet_dialog_done
Cnd_CommComplete = DX_M03_1040_wilham
Act_ActTrig = mission_briefing

[Trigger]
nickname = mission_briefing
Cnd_Timer = 2
;Reichman: Briefing 1
Act_EtherComm = echo_m03, 093503, Player, DX_M03_0020_reichman, -1, rh_reichman_head, rh_reichman_body, prop_neuralnet_A_right

;Reichman: Briefing 2
Act_EtherComm = echo_m03, 093504, Player, DX_M03_0030_reichman, -1, rh_reichman_head, rh_reichman_body, prop_neuralnet_A_right

;Reichman: Briefing 3
Act_EtherComm = echo_m03, 093505, Player, DX_M03_0035_reichman, -1, rh_reichman_head, rh_reichman_body, prop_neuralnet_A_right

Act_ActTrig = first_meet_fleet

[Trigger]
nickname = first_meet_fleet
Cnd_DistVec = inside, Player, {{ m3_init_point.pos }}, 2000
Act_ActTrig = mission_briefing_last
Act_ActTrig = remove_starke_formation
Act_MarkObj = wilham, 0
{{ nag.nag_off() }}
Act_ActTrig = briefieng_dialog
Act_ActTrig = briefieng_dialog_complete

[Trigger]
nickname = mission_briefing_last
Cnd_True = no_params
;Reichman: Briefing 4
Act_EtherComm = echo_m03, 093506, Player, DX_M03_0040_reichman, -1, rh_reichman_head, rh_reichman_body, prop_neuralnet_A_right

;Reichman: Briefing 5
Act_EtherComm = echo_m03, 093507, Player, DX_M03_0050_reichman, -1, rh_reichman_head, rh_reichman_body, prop_neuralnet_A_right


[Trigger]
nickname = briefieng_dialog_complete
Cnd_CommComplete = DX_M03_0050_reichman
Act_GiveObjList = Player, punishers_follow_player
Act_GiveObjList = {{ assist.member(1) }}, goto_sp01_jumphole
{{ nn_sig8_to_kgb_fly.set() }}

;Hassler: Let's go
Act_EtherComm = echo_m03, 093564, Player, DX_M03_1050_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman

Act_ActTrig = before_jumphole_dialog
Act_ActTrig = near_jumphole

[Trigger]
nickname = before_jumphole_dialog
Cnd_DistVec = inside, Player, {{ sig8_to_kgb.name }}, 6000
;Assistance: Anomaly detected
Act_EtherComm = echo_m03, 093565, Player, DX_M03_1060_marauder, -1, li_captain_head, rh_male_guard_body, comm_rh_guard

;Hassler: Preparing the device
Act_EtherComm = echo_m03, 093566, Player, DX_M03_1070_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman


[Trigger]
nickname = near_jumphole
Cnd_DistShip = inside, Player, {{ sig8_to_kgb.name }}, 1000
Act_PlayMusic = music_anticipation_light, none, none, none
Act_ActTrig = remove_punishers_formation

{{ nn_wait_for_activation.set() }}

;Hassler: We are here. Init activation
Act_EtherComm = echo_m03, 093508, Player, DX_M03_0060_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman

Act_ActTrig = near_jumphole_dialog_ends

[Trigger]
nickname = near_jumphole_dialog_ends
Cnd_CommComplete = DX_M03_0060_hassler
Act_ActTrig = wait_for_jumphole_activation

[Trigger]
nickname = wait_for_jumphole_activation
Cnd_Timer = 2
{{ thorn_m03_jumphole_activation.call() }}
Act_PObjIdle = no_params
Act_LightFuse = {{ sig8_to_kgb.name }}, msn03_jumphole_init
Act_ActTrig = reseat_jh_activation_cam

[Trigger]
nickname = reseat_jh_activation_cam
Cnd_Timer = 3
Act_RevertCam = no_params
Act_Invulnerable = Player, false
Act_ActTrig = lets_jump_to_kgb_dialog

[Trigger]
nickname = lets_jump_to_kgb_dialog
Cnd_Timer = 1
;Hassler: Activated!
Act_EtherComm = echo_m03, 093509, Player, DX_M03_0065_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman

Act_EnableManeuver = dock, true
Act_LockDock = Player, {{ sig8_to_kgb.name }}, unlock
{{ nn_sig8_to_kgb.set() }}

Act_ActTrig = welcome_to_kgb

[Trigger]
nickname = spawn_kgb
Cnd_True = no_params
Act_SpawnSolar = {{ kgb.name }}
Act_SpawnSolar = {{ dock1.name }}
Act_SpawnSolar = {{ dock2.name }}
Act_Invulnerable = {{ kgb.name }}, true
Act_Invulnerable = {{ dock1.name }}, true
Act_Invulnerable = {{ dock2.name }}, true
Act_ActTrig = KGB_SHIELD_ZONE
Act_SpawnSolar = {{ gen1.name }}
Act_SpawnSolar = {{ gen2.name }}
Act_SpawnSolar = {{ gen1_laser.name }}
Act_SpawnSolar = {{ gen2_laser.name }}
Act_Invulnerable = {{ gen1.name }}, true
Act_Invulnerable = {{ gen2.name }}, true

[Trigger]
nickname = welcome_to_kgb
Cnd_NPCSystemEnter = rh_kgb, {{ hassler.member() }}, {{ punisher.member(1) }}, Player
{{ nag.nag_off() }}
Act_ActTrig = kgb_welcome_wait_complete
Act_PlayMusic = no_params
Act_LockDock = Player, {{ sig8_to_kgb.name }}, lock

[Trigger]
nickname = kgb_welcome_wait_complete
Cnd_Timer = 1
;Hassler: Corsairs! Regroup!
Act_EtherComm = echo_m03, 093510, Player, DX_M03_0070_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman

{{ nag.nag_voice }}
{{ nn_destroy_corsairs.set() }}
{{ nag.combat('welcome_kgb_battle', hassler) }}
Act_ActTrig = init_welcome_kgb_battle
Act_PlayMusic = music_iw_space, music_iw_danger, music_iw_battle, none
Act_ActTrig = kgb_welcome_spawn_kgb

[Trigger]
nickname = kgb_welcome_spawn_kgb
Cnd_Timer = 3
Act_ActTrig = spawn_kgb

[Trigger]
nickname = init_welcome_kgb_battle
Cnd_True = no_params
{{ kgb_welcome_fighter.spawn_all() }}

Act_ActTrig = default_corsair_battle_setrep

{{ kgb_welcome_fighter.mark_all() }}

Act_ActTrig = welcome_kgb_battle_COMPLETE


[Trigger]
nickname = default_corsair_battle_setrep
Cnd_True = no_params
Act_SetVibeLbl = friend, enemy, REP_HOSTILE_MAXIMUM
Act_SetVibeLbl = enemy, friend, REP_HOSTILE_MAXIMUM
Act_SetVibeLblToShip = enemy, Player, REP_HOSTILE_MAXIMUM
Act_SetVibeShipToLbl = Player, enemy, REP_HOSTILE_MAXIMUM

[Trigger]
nickname = welcome_kgb_battle_COMPLETE
Cnd_Destroyed = first_meet, -1, ALL_IGNORE_LANDING
Act_PlayMusic = music_iw_space, music_iw_space, music_iw_space, music_iw_space
;Assistance:
Act_EtherComm = echo_m03, 093569, Player, DX_M03_1100_marauder, -1, li_captain_head, rh_male_guard_body, comm_rh_guard

Act_ActTrig = init_koenigsberg

[Trigger]
nickname = init_koenigsberg
Cnd_CommComplete = DX_M03_1100_marauder
;Hassler: We need to go
Act_EtherComm = echo_m03, 093570, Player, DX_M03_1110_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman

Act_GiveObjList = Player, punishers_follow_player
Act_GiveObjList = {{ assist.member(1) }}, regroup_assistance
Act_GiveObjList = {{ assist.member(1) }}, force_follow_player
{{ nn_goto_nebula_exit.set() }}
Act_ActTrig = we_are_founded

[Trigger]
nickname = we_are_founded
Cnd_DistVec = inside, Player, {{ nebula_exit.pos }}, 800
;;Act_GiveObjList = Player, force_stop
{{ nag.nag_off() }}
Act_Save = FOUNDED_SAVE, 093303
Act_ActTrig = init_FOUNDED_REACTION

[Trigger]
nickname = FOUNDED_SAVE
Cnd_SpaceEnter = no_params
Act_RevertCam = no_params
Act_ActTrig = INIT_FOUNDED_SAVE

[Trigger]
nickname = INIT_FOUNDED_SAVE
Cnd_Timer = 0.3
Act_RelocateShip = Player, {{ nebula_exit.pos_orient }}

Act_ActTrig = spawn_kgb
Act_SpawnShip = nag_voice
Act_SpawnShip = {{ hassler.member() }}, no_ol, {{ neb_hassler.pos_orient }}
Act_SpawnFormation = assist_wing, {{ neb_assist.pos_orient }}
Act_SpawnShip = {{ punisher.member(1) }}, no_ol, {{ neb_punisher1.pos_orient }}
Act_SpawnShip = {{ punisher.member(2) }}, no_ol, {{ neb_punisher2.pos_orient }}
Act_SpawnShip = {{ punisher.member(3) }}, no_ol, {{ neb_punisher3.pos_orient }}
Act_SpawnShip = {{ punisher.member(4) }}, no_ol, {{ neb_punisher4.pos_orient }}
Act_MarkObj = hassler, 1
Act_ActTrig = FOUNDED_SAVE_WAIT

[Trigger]
nickname = FOUNDED_SAVE_WAIT
Cnd_Timer = 0.2
Act_ActTrig = general_triggers
Act_GiveObjList = Player, punishers_follow_player
Act_ActTrig = init_FOUNDED_REACTION

[Trigger]
nickname = init_FOUNDED_REACTION
Cnd_True = no_params
;Hassler: Do main objective
Act_EtherComm = echo_m03, 093511, Player, DX_M03_0080_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman

;Assistance: Roger that!
Act_EtherComm = echo_m03, 093572, Player, DX_M03_1130_marauder, -1, li_captain_head, rh_male_elite_body, comm_rh_elite

Act_GiveObjList = {{ assist.member(1) }}, goto_generator2
Act_ActTrig = init_COUNTDOWN_TIMER
Act_ActTrig = init_GENERATOR_ONE
Act_PlayMusic = none, none, none, music_anticipation_more_forboding

[Trigger]
nickname = init_COUNTDOWN_TIMER
Cnd_Timer = 2
Act_EtherComm = nn_mod, 093101, Player, m3_timer_ten, -1, no_head, robot_body_E
Act_ActTrig = coundown_9

[Trigger]
nickname = coundown_9
Cnd_Timer = 60
Act_EtherComm = nn_mod, 093102, Player, m3_timer_nine, -1, no_head, robot_body_E
Act_ActTrig = coundown_8

[Trigger]
nickname = coundown_8
Cnd_Timer = 60
Act_EtherComm = nn_mod, 093103, Player, m3_timer_eight, -1, no_head, robot_body_E
Act_ActTrig = coundown_7

[Trigger]
nickname = coundown_7
Cnd_Timer = 60
Act_EtherComm = nn_mod, 093104, Player, m3_timer_seven, -1, no_head, robot_body_E
Act_ActTrig = coundown_6

[Trigger]
nickname = coundown_6
Cnd_Timer = 60
Act_EtherComm = nn_mod, 093105, Player, m3_timer_six, -1, no_head, robot_body_E
Act_ActTrig = coundown_5

[Trigger]
nickname = coundown_5
Cnd_Timer = 60
Act_EtherComm = nn_mod, 093106, Player, m3_timer_five, -1, no_head, robot_body_E
Act_ActTrig = coundown_4

[Trigger]
nickname = coundown_4
Cnd_Timer = 60
Act_EtherComm = nn_mod, 093107, Player, m3_timer_four, -1, no_head, robot_body_E
Act_ActTrig = coundown_3

[Trigger]
nickname = coundown_3
Cnd_Timer = 60
Act_EtherComm = nn_mod, 093108, Player, m3_timer_three, -1, no_head, robot_body_E
Act_ActTrig = coundown_2

[Trigger]
nickname = coundown_2
Cnd_Timer = 60
Act_EtherComm = nn_mod, 093109, Player, m3_timer_two, -1, no_head, robot_body_E
Act_ActTrig = coundown_1

[Trigger]
nickname = coundown_1
Cnd_Timer = 60
Act_EtherComm = nn_mod, 093110, Player, m3_timer_one, -1, no_head, robot_body_E
Act_ActTrig = coundown_30s

[Trigger]
nickname = coundown_30s
Cnd_Timer = 30
Act_EtherComm = nn_mod, 093111, Player, m3_timer_last, -1, no_head, robot_body_E
Act_ActTrig = coundown_complete

[Trigger]
nickname = coundown_complete
Cnd_Timer = 30
Act_ChangeState = FAIL, 093112

[Trigger]
nickname = disable_COUNTDOWN_TIMER
Cnd_True = no_params
Act_DeActTrig = coundown_9
Act_DeActTrig = coundown_8
Act_DeActTrig = coundown_7
Act_DeActTrig = coundown_6
Act_DeActTrig = coundown_5
Act_DeActTrig = coundown_4
Act_DeActTrig = coundown_3
Act_DeActTrig = coundown_2
Act_DeActTrig = coundown_1
Act_DeActTrig = coundown_30s
Act_DeActTrig = coundown_complete

[Trigger]
nickname = init_GENERATOR_ONE
Cnd_True = no_params
{{ nn_goto_gen1.set() }}
Act_ActTrig = generator_one_FAR
Act_ActTrig = generator_one_CLOSE
Act_ActTrig = generator_one_AROUND_GENERATOR_TWO

[Trigger]
nickname = generator_one_AROUND_GENERATOR_TWO
Cnd_DistShip = inside, Player, {{ gen2.name }} , 4000
Act_ChangeState = FAIL, 093115

[Trigger]
nickname = generator_one_FAR
Cnd_DistShip = inside, Player, {{ gen1.name }}, 4000
Act_Invulnerable = {{ gen1.name }}, false

{{ assist.hide_all() }}
{{ gen1_defence.spawn_all_slide() }}

Act_ActTrig = default_corsair_battle_setrep
Act_PlayMusic = music_iw_space, music_iw_danger, music_iw_battle, none

[Trigger]
nickname = generator_one_CLOSE
Cnd_DistShip = inside, Player, {{ gen1.name }}, 1000
Act_GiveObjList = Player, force_stop
Act_ActTrig = remove_punishers_formation
{{ nn_destroy_gen1.set() }}
{{ nag.combat('gen1_battle', hassler) }}
Act_ActTrig = generator_one_destroyed

[Trigger]
nickname = generator_one_destroyed
Cnd_Destroyed = {{ gen1.name }}
Act_ActTrig = generator_one_lastergen_fuse

[Trigger]
nickname = generator_one_lastergen_fuse
Cnd_Timer = 2
Act_LightFuse = {{ gen1_laser.name }}, fuse_kgb_lasergen
Act_ActTrig = after_gen1

[Trigger]
nickname = after_gen1
Cnd_Destroyed = {{ gen1_laser.name }}
{{ nn_destroy_corsairs.set() }}
Act_ActTrig = gen1_reinforcement

;Hassler: Generator 1 has been destroyed
Act_EtherComm = echo_m03, 093512, Player, DX_M03_0090_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman

Act_ActTrig = after_gen1_dialog_done

[Trigger]
nickname = gen1_reinforcement
Cnd_True = no_params

{{ gen1_reinforcement.spawn_all() }}

Act_ActTrig = default_corsair_battle_setrep

{{ gen1_defence.mark_all() }}
{{ gen1_reinforcement.mark_all() }}

[Trigger]
nickname = after_gen1_dialog_done
Cnd_CommComplete = DX_M03_0090_hassler
ACt_ActTrig = marauder_last_dialog

[Trigger]
nickname = marauder_last_dialog
Cnd_Timer = 2
;Hassler: Marauder-1, regroup with us
Act_EtherComm = echo_m03, 093513, Player, DX_M03_0100_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman

;Assistance: We can't!... (dead)
Act_EtherComm = echo_m03, 093514, Player, DX_M03_0110_marauder, -1, li_captain_head, rh_male_elite_body, comm_rh_elite

;Hassler: HQ, we lost marauder wing
Act_EtherComm = echo_m03, 093515, Player, DX_M03_0120_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman

Act_ActTrig = marauder_last_dialog_done

[Trigger]
nickname = marauder_last_dialog_done
Cnd_CommComplete = DX_M03_0120_hassler
Act_ActTrig = init_GENERATOR_TWO

[Trigger]
nickname = gen1_is_not_interesting
Cnd_True = no_params
{{ gen1_defence.unmark_all() }}
{{ gen1_reinforcement.unmark_all() }}
Act_SetVibeLbl = friend, enemy, REP_HOSTILE_THRESHOLD
Act_SetVibeLbl = enemy, friend, REP_HOSTILE_THRESHOLD
Act_SetVibeLblToShip = enemy, Player, REP_HOSTILE_THRESHOLD
Act_SetVibeShipToLbl = Player, enemy, REP_HOSTILE_THRESHOLD

[Trigger]
nickname = remove_gen1_enemies
Cnd_True = no_params
{{ gen1_defence.hide_all() }}
{{ gen1_reinforcement.hide_all() }}

[Trigger]
nickname = init_GENERATOR_TWO
Cnd_True = no_params
;Reichman: Affirmative
Act_EtherComm = echo_m03, 093516, Player, DX_M03_0130_reichman, -1, rh_reichman_head, rh_reichman_body, prop_neuralnet_A_right

Act_ActTrig = gen1_is_not_interesting
Act_GiveObjList = Player, punishers_follow_player
{{ nn_goto_gen2_wp1.set() }}
Act_ActTrig = GENERATOR_TWO_vec1

[Trigger]
nickname = GENERATOR_TWO_vec1
Cnd_DistVec = inside, Player, {{ wp_to_gen1.pos }}, 2000
{{ nn_goto_gen2_wp2.set() }}
Act_ActTrig = GENERATOR_TWO_vec2
Act_ActTrig = deidrich_greetings_dialog

[Trigger]
nickname = GENERATOR_TWO_vec2
Cnd_DistVec = inside, Player, {{ wp_to_gen2.pos }}, 2000
{{ nn_goto_gen2.set() }}
Act_ActTrig = generator_two_FAR
Act_ActTrig = generator_two_CLOSE
Act_PlayMusic = none, none, none, music_reveal_and_exposition
Act_DeactTrig = generator_one_AROUND_GENERATOR_TWO

[Trigger]
nickname = deidrich_greetings_dialog
Cnd_Timer = 5
;Deidrich: Hassler, you are next
Act_EtherComm = echo_m03, 093517, Player, DX_M03_0140_deidrich, -1, rh_deidrich_head, rh_deidrich_body

;Hassler: Hello, betrayer!
Act_EtherComm = echo_m03, 093518, Player, DX_M03_0150_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman

;Deidrich: Kaiser is fool! Join us!
Act_EtherComm = echo_m03, 093519, Player, DX_M03_0160_deidrich, -1, rh_deidrich_head, rh_deidrich_body

;Hassler: I don't!
Act_EtherComm = echo_m03, 093520, Player, DX_M03_0170_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman



[Trigger]
nickname = generator_two_FAR
Cnd_DistShip = inside, Player, {{ gen2.name }}, 3000
{{ gen2_main_defence.spawn_all_slide() }}
{{ gen2_second_defence.spawn_all_slide() }}
Act_ActTrig = default_corsair_battle_setrep
Act_ActTrig = remove_gen1_enemies
Act_PlayMusic = music_iw_space, music_iw_danger, music_iw_battle, none

[Trigger]
nickname = generator_two_CLOSE
Cnd_DistShip = inside, Player, {{ gen2.name }}, 1200
Act_Invulnerable = {{ gen2.name }}, false
Act_GiveObjList = Player, force_stop
Act_ActTrig = remove_punishers_formation
{{ nn_destroy_gen2.set() }}
{{ nag.combat('generator2_battle', hassler) }}
Act_ActTrig = gen2_destroyed

[Trigger]
nickname = gen2_destroyed
Cnd_Destroyed = {{ gen2.name }}
Act_ActTrig = disable_COUNTDOWN_TIMER
Act_ActTrig = generator_two_lastergen_fuse

[Trigger]
nickname = generator_two_lastergen_fuse
Cnd_Timer = 2
Act_LightFuse = {{ gen2_laser.name }}, fuse_kgb_lasergen
Act_ActTrig = gen2_lasergen_destroyed

[Trigger]
nickname = gen2_lasergen_destroyed
Cnd_Destroyed = {{ gen2_laser.name }}
Act_ActTrig = co_reinforcement

[Trigger]
nickname = co_reinforcement
Cnd_True = no_params
{{ gen2_co_reinforcement.spawn_all() }}
{{ gen2_rh_reinforcement.spawn_all() }}
Act_ActTrig = mark_all_gen2_enemy
Act_ActTrig = default_corsair_battle_setrep
Act_SetNNObj = m3_destroy_corsairs
;Hassler:
Act_EtherComm = echo_m03, 093521, Player, DX_M03_0180_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman

;Reichman: Affirmative
Act_EtherComm = echo_m03, 093522, Player, DX_M03_0190_reichman, -1, rh_reichman_head, rh_reichman_body, prop_neuralnet_A_right

Act_ActTrig = gen2_reichman_dlg_ends

[Trigger]
nickname = mark_all_gen2_enemy
Cnd_True = no_params
{{ gen2_main_defence.mark_all() }}
{{ gen2_second_defence.mark_all() }}
{{ gen2_co_reinforcement.mark_all() }}
{{ gen2_rh_reinforcement.mark_all() }}

[Trigger]
nickname = gen2_reichman_dlg_ends
Cnd_CommComplete = DX_M03_0190_reichman
Act_ActTrig = wilham_greetings

[Trigger]
nickname = wilham_greetings
Cnd_Timer = 5
Act_ActTrig = spawn_KGB_RH_FLEET
Act_ActTrig = KGB_FLEET_cam
Act_PlayMusic = music_danger, music_danger, music_dangerous_chase, music_reveal_enemy_position_of_strength, 1

[Trigger]
nickname = spawn_KGB_RH_FLEET
Cnd_True = no_params
Act_SpawnShip = wilham, no_ol, {{ wilham_arrive.pos_orient }}
Act_SpawnFormation = fleet_wing, {{ wing_arrive.pos_orient }}
Act_SpawnShip = gunship_1, no_ol, {{ gb1_arrive.pos_orient }}
Act_SpawnShip = gunship_2, no_ol, {{ gb2_arrive.pos_orient }}
Act_SpawnShip = gunship_3, no_ol, {{ gb3_arrive.pos_orient }}
Act_SpawnShip = gunship_4, no_ol, {{ gb4_arrive.pos_orient }}
Act_SpawnShip = cruiser_1, no_ol, {{ cr1_arrive.pos_orient }}
Act_SpawnShip = cruiser_2, no_ol, {{ cr2_arrive.pos_orient }}
Act_SpawnShip = battleship_1, no_ol, {{ bsh_arrive.pos_orient }}
Act_ActTrig = get_friendship
Act_ActTrig = default_corsair_battle_setrep

[Trigger]
nickname = KGB_FLEET_cam
Cnd_Timer = 1
; Act_StaticCam = 24443, 83, -32912, 1, -0.05, -3.25, 0
Act_CallThorn = scripts\mod\m03_fleet_arrive.thn, Player
Act_Invulnerable = Player, true
Act_ActTrig = KGB_FLEET_cam_REVERT

[Trigger]
nickname = KGB_FLEET_cam_REVERT
Cnd_Timer = 6.1
Act_Invulnerable = Player, false

Act_ActTrig = KGB_FLEET_dialog
Act_ActTrig = generator_defend_destroyed

[Trigger]
nickname = KGB_FLEET_dialog
Cnd_Timer = 2
;Wilham: Reinfocment has arrived
Act_EtherComm = echo_m03, 093574, Player, DX_M03_1150_wilham, -1, rh_wilham_head, rh_wilham_body, comm_rh_wilham

;Hassler: Ok!
Act_EtherComm = echo_m03, 093575, Player, DX_M03_1160_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman

Act_ActTrig = begin_GEN2_Battle

[Trigger]
nickname = begin_GEN2_Battle
Cnd_CommComplete = DX_M03_1160_hassler
Act_PlayMusic = music_danger, music_danger, music_dangerous_chase, music_dangerous_chase

[Trigger]
nickname = generator_defend_destroyed
Cnd_Destroyed = gen2_defender, -1, ALL_IGNORE_LANDING
Act_PlayMusic = no_params
Act_ActTrig = KGB_SHIELD_ZONE_turn_off
Act_ActTrig = kgb_without_shieldgen_turn_off_shield
Act_ActTrig = after_generator

[Trigger]
nickname = spawn_kgb_without_shieldgen
Cnd_True = no_params
Act_SpawnSolar = {{ kgb.name }}
Act_SpawnSolar = {{ dock1.name }}
Act_SpawnSolar = {{ dock2.name }}
Act_Invulnerable = {{ kgb.name }}, true
Act_Invulnerable = {{ dock1.name }}, true
Act_Invulnerable = {{ dock2.name }}, true
Act_ActTrig = kgb_without_shieldgen_turn_off_shield

[Trigger]
nickname = kgb_without_shieldgen_turn_off_shield
Cnd_Timer = 2
Act_LightFuse = kgb, kgb_shield_turn_off

[Trigger]
nickname = after_generator
Cnd_Timer = 2
Act_ActTrig = everybody_goes_to_freeport
Act_NagOff = generator2_battle
Act_GiveObjList = Player, punishers_follow_player
Act_Save = SAVE_SHIELD_DOWN, 093304
Act_ActTrig = init_SHIELD_DOWN

[Trigger]
nickname = everybody_goes_to_freeport
Cnd_True = no_params
Act_GiveObjList = wilham, basic_goto_freeport
Act_GiveObjList = {{ fleet_fighter.member(1) }}, basic_goto_freeport
Act_GiveObjList = gunship_1, gunship_1_goto
Act_GiveObjList = gunship_2, gunship_2_goto
Act_GiveObjList = gunship_3, gunship_3_goto
Act_GiveObjList = gunship_4, gunship_4_goto
Act_GiveObjList = cruiser_1, cruiser_1_goto
Act_GiveObjList = cruiser_2, cruiser_2_goto
Act_GiveObjList = battleship_1, battleship_1_goto

[Trigger]
nickname = SAVE_SHIELD_DOWN
Cnd_SpaceEnter = no_params
Act_RevertCam = no_params
Act_ActTrig = INIT_SAVE_SHIELD_DOWN

[Trigger]
nickname = INIT_SAVE_SHIELD_DOWN
Cnd_Timer = 0.3

Act_ActTrig = spawn_kgb_without_shieldgen
; Act_ActTrig = hide_destroyed_objects
Act_RelocateShip = Player, {{ catcher_player.pos_orient }}
{{ nag.nag_voice }}
Act_SpawnShip = {{ hassler.member() }}, no_ol, {{ catcher_hassler.pos_orient }}
Act_SpawnShip = {{ punisher.member(1) }}, no_ol, {{ catcher_punisher1.pos_orient }}
Act_SpawnShip = {{ punisher.member(2) }}, no_ol, {{ catcher_punisher2.pos_orient }}
Act_SpawnShip = {{ punisher.member(3) }}, no_ol, {{ catcher_punisher3.pos_orient }}
Act_SpawnShip = {{ punisher.member(4) }}, no_ol, {{ catcher_punisher4.pos_orient }}
Act_MarkObj = {{ hassler.member() }}, 1
Act_SpawnShip = wilham, basic_goto_freeport, {{ wilham_arrive.pos_orient }}
Act_SpawnFormation = fleet_wing, {{ wing_arrive.pos_orient }}
Act_SpawnShip = gunship_1, gunship_1_goto, {{ gb1_arrive.pos_orient }}
Act_SpawnShip = gunship_2, gunship_2_goto, {{ gb2_arrive.pos_orient }}
Act_SpawnShip = gunship_3, gunship_3_goto, {{ gb3_arrive.pos_orient }}
Act_SpawnShip = gunship_4, gunship_4_goto, {{ gb4_arrive.pos_orient }}
Act_SpawnShip = cruiser_1, cruiser_1_goto, {{ cr1_arrive.pos_orient }}
Act_SpawnShip = cruiser_2, cruiser_2_goto, {{ cr2_arrive.pos_orient }}
Act_SpawnShip = battleship_1, battleship_1_goto, {{ bsh_arrive.pos_orient }}
Act_ActTrig = general_triggers
Act_ActTrig = SAVE_SHIELD_DOWN_WAIT

[Trigger]
nickname = SAVE_SHIELD_DOWN_WAIT
Cnd_Timer = 0.2
Act_GiveObjList = Player, punishers_follow_player
Act_GiveObjList = {{ fleet_fighter.member(1) }}, basic_goto_freeport
Act_ActTrig = init_SHIELD_DOWN

[Trigger]
nickname = init_SHIELD_DOWN
Cnd_True = no_params
Act_PlayMusic = none, none, none, music_upcoming_action_heavy
{{ nn_goto_kgb_core.set() }}
;Hassler: Punishers, go to base
Act_EtherComm = echo_m03, 093576, Player, DX_M03_1170_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman

Act_ActTrig = in_shield

[Trigger]
nickname = in_shield
Cnd_DistVec = inside, Player, {{ kgb.pos }}, 6000
Act_ActTrig = init_ESCAPERS
Act_ActTrig = init_LAST_CORSAIRS_CATCH
;Player: What is that ships???
Act_EtherComm = echo_m03_player, 093523, Player, DX_M03_0200_trent, -1, pi_pirate5_head, player_body, player_commhelmet

;Hassler: Damn, this is Deidrich!
Act_EtherComm = echo_m03, 093524, Player, DX_M03_0210_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman


[Trigger]
nickname = init_ESCAPERS
Cnd_Timer = 1
Act_SpawnFormation = escapers_1, {{ escaper1_start.pos_orient }}
Act_SpawnFormation = escapers_2, {{ escaper2_start.pos_orient }}
Act_SpawnFormation = escapers_3, {{ escaper3_start.pos_orient }}
Act_SpawnFormation = escapers_4, {{ escaper4_start.pos_orient }}
Act_ActTrig = init_LAST_CORSAIRS
Act_GiveObjList = {{ escaper1.member(1) }}, escape_point_1
Act_GiveObjList = {{ escaper2.member(1) }}, escape_point_2
Act_GiveObjList = {{ escaper3.member(1) }}, escape_point_3
Act_GiveObjList = {{ escaper4.member(1) }}, escape_point_4
Act_SetVibeLbl = friend, escaper, REP_NEUTRAL
Act_SetVibeLbl = escaper, friend, REP_NEUTRAL
Act_SetVibeLblToShip = escaper, Player, REP_NEUTRAL
Act_SetVibeShipToLbl = Player, escaper, REP_NEUTRAL

[Trigger]
nickname = init_LAST_CORSAIRS
Cnd_Timer = 2
Act_SpawnFormation = evil_wing, 24400, 0, -40000, 0.7, 0, 0.7, 0
{{ last_defence.spawn_all_slide() }}
Act_ActTrig = LAST_CORSAIRS_misc_triggers
Act_GiveObjList = {{ evil_freighter.member() }}, deidrich_point_1
Act_SetVibeLbl = friend, defend, REP_HOSTILE_THRESHOLD
Act_SetVibeLbl = defend, friend, REP_HOSTILE_THRESHOLD
Act_SetVibeLblToShip = defend, Player, REP_NEUTRAL
Act_SetVibeShipToLbl = Player, defend, REP_NEUTRAL
Act_SetVibeLbl = friend, deidrich_team, REP_NEUTRAL
Act_SetVibeLbl = deidrich_team, friend, REP_NEUTRAL
Act_SetVibeLbl = trent_wing, defend, REP_NEUTRAL
Act_SetVibeLbl = defend, trent_wing, REP_NEUTRAL
Act_SetVibeLblToShip = deidrich_team, Player, REP_HOSTILE_MAXIMUM
Act_SetVibeShipToLbl = Player, deidrich_team, REP_HOSTILE_MAXIMUM
Act_MarkObj = deidrich, 1

[Trigger]
nickname = init_LAST_CORSAIRS_CATCH
Cnd_CommComplete = DX_M03_0210_hassler
;Reichman: Catch him!
Act_EtherComm = echo_m03, 093525, Player, DX_M03_0220_reichman, -1, rh_reichman_head, rh_reichman_body, prop_neuralnet_A_right

;Hassler: Catch the Deidrich
Act_EtherComm = echo_m03, 093526, Player, DX_M03_0230_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman

{{ nn_goto_deidrich.set() }}

Act_ActTrig = CATCH_DEIDRICH
Act_ActTrig = DEIDRICH_WAYPOINT

[Trigger]
nickname = DEIDRICH_WAYPOINT
Cnd_True = no_params
Act_ActTrig = DEIDRICH_WAYPOINT_23000  ; 2
Act_ActTrig = DEIDRICH_WAYPOINT_22000  ; 3
Act_ActTrig = DEIDRICH_WAYPOINT_20000  ; 4
Act_ActTrig = DEIDRICH_WAYPOINT_18000  ; 5
Act_ActTrig = DEIDRICH_WAYPOINT_16000  ; 6
Act_ActTrig = DEIDRICH_WAYPOINT_14000  ; 7

[Trigger]
nickname = DEIDRICH_WAYPOINT_23000
Cnd_DistVec = inside, evil_freighter, {{ deidrich2.pos }}, 500
{{ nn_goto_deidrich_pos2.set() }}

[Trigger]
nickname = DEIDRICH_WAYPOINT_22000
Cnd_DistVec = inside, evil_freighter, {{ deidrich3.pos }}, 700
{{ nn_goto_deidrich_pos3.set() }}

[Trigger]
nickname = DEIDRICH_WAYPOINT_20000
Cnd_DistVec = inside, evil_freighter, {{ deidrich4.pos }}, 700
{{ nn_goto_deidrich_pos4.set() }}

[Trigger]
nickname = DEIDRICH_WAYPOINT_18000
Cnd_DistVec = inside, evil_freighter, {{ deidrich5.pos }}, 700
{{ nn_goto_deidrich_pos5.set() }}

[Trigger]
nickname = DEIDRICH_WAYPOINT_16000
Cnd_DistVec = inside, evil_freighter, {{ deidrich6.pos }}, 700
{{ nn_goto_deidrich_pos6.set() }}

[Trigger]
nickname = DEIDRICH_WAYPOINT_14000
Cnd_DistVec = inside, evil_freighter, {{ deidrich7.pos }}, 700
{{ nn_goto_deidrich_pos7.set() }}


[Trigger]
nickname = DEIDRICH_WAYPOINT_turn_off
Cnd_True = no_params
Act_DeActTrig = DEIDRICH_WAYPOINT_23000
Act_DeActTrig = DEIDRICH_WAYPOINT_22000
Act_DeActTrig = DEIDRICH_WAYPOINT_20000
Act_DeActTrig = DEIDRICH_WAYPOINT_18000
Act_DeActTrig = DEIDRICH_WAYPOINT_16000
Act_DeActTrig = DEIDRICH_WAYPOINT_14000

[;
;deidrich points
23000, 0, -40000
22000, 0, -40000
20000, 0, -40000
18000, 0, -40000
16000, 0, -40000
14000, 0, -40000
12000, 0, -40000

[Trigger]
nickname = CATCH_DEIDRICH
Cnd_True = no_params
Act_ActTrig = DEIDRICH_too_far_LARGE
Act_ActTrig = DEIDRICH_in_our_point
{{ evil_freighter.invulnerable(true) }}
{{ deidrich.invulnerable(true) }}
{{ evil_fighter.invulnerable(true) }}
{{ deidrich.mark_all() }}

[Trigger]
nickname = DEIDRICH_too_far_LARGE
Cnd_DistShip = outside, Player, deidrich, 10000
Act_ChangeState = FAIL, 093113

[Trigger]
nickname = DEIDRICH_in_our_point
Cnd_DistVec = inside, deidrich, {{ deidrich8.pos }}, 500
Act_GiveObjList = {{ deidrich.member() }}, fight_with_trent
{{ evil_fighter.give_objlist_all('fight_with_trent') }}
Act_GiveObjList = {{ evil_freighter.member() }}, deidrich_point_2

Act_SetVibeLbl = friend, deidrich_defend, REP_HOSTILE_MAXIMUM
Act_SetVibeLbl = deidrich_defend, friend, REP_HOSTILE_MAXIMUM
Act_SetVibeLblToShip = deidrich_defend, Player, REP_HOSTILE_MAXIMUM
Act_SetVibeShipToLbl = Player, deidrich_defend, REP_HOSTILE_MAXIMUM

Act_SetVibe = deidrich, Player, REP_HOSTILE_MAXIMUM
Act_SetVibe = Player, deidrich, REP_HOSTILE_MAXIMUM
Act_SetVibeLblToShip = friend, deidrich, REP_HOSTILE_MAXIMUM
Act_SetVibeShipToLbl = deidrich, friend, REP_NEUTRAL


Act_DeactTrig = DEIDRICH_too_far_LARGE
Act_Invulnerable = {{ deidrich.member() }}, false
{{ evil_fighter.invulnerable(false) }}

Act_ActTrig = DEIDRICH_WAYPOINT_turn_off
{{ nn_destroy_deidrich.set() }}
Act_ActTrig = DEIDRICH_fight
Act_ActTrig = DEIDRICH_fight_dialog

{{ deidrich.mark_all() }}

[Trigger]
nickname = DEIDRICH_fight_dialog
Cnd_True = no_params
Act_PlayMusic = music_danger, music_danger, music_dangerous_chase, none
;Hassler: Destroy enemy ships!
Act_EtherComm = echo_m03, 093527, Player, DX_M03_0240_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman

Act_ActTrig = DEIDRICH_fight_dialog_done

[Trigger]
nickname = DEIDRICH_fight_dialog_done
Cnd_CommComplete = DX_M03_0240_hassler
Act_ActTrig = DEIDRICH_freighter_going_away_dialog

[Trigger]
nickname = DEIDRICH_freighter_going_away_dialog
Cnd_Timer = 3
;Player: Freighter going away
Act_EtherComm = echo_m03_player, 093528, Player, DX_M03_0250_trent, -1, pi_pirate5_head, player_body, player_commhelmet

;Hassler: That's not matter
Act_EtherComm = echo_m03, 093529, Player, DX_M03_0260_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman


[Trigger]
nickname = DEIDRICH_fight
Cnd_DistShip = inside, Player, {{ deidrich.member() }}, 500
Act_PObjIdle = no_params
Act_ActTrig = remove_punishers_formation
Act_ActTrig = deidrich_destroyed
Act_ActTrig = deidrich_extra_defence01
Act_ActTrig = hide_fleet_fighters

[Trigger]
nickname = deidrich_extra_defence_dialog
Cnd_True = no_params
;Punisher:
Act_EtherComm = echo_m03, 093579, Player, DX_M03_1200_punisher, -1,  rh_sales_head, rh_male_elite_body, comm_rh_elite

;Hassler:
Act_EtherComm = echo_m03, 093580, Player, DX_M03_1210_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman


;

[Trigger]
nickname = deidrich_extra_defence01
Cnd_HealthDec = deidrich, 0.8
Act_LightFuse = deidrich, fuse_m03_deidrich_extra_shield01
Act_Invulnerable = deidrich, true
Act_ActTrig = deidrich_extra_defence01_turn_off
Act_ActTrig = deidrich_extra_defence_dialog

[Trigger]
nickname = deidrich_extra_defence01_turn_off
Cnd_Timer = 10
Act_LightFuse = deidrich, fuse_m03_deidrich_extra_shield01_turn_off
Act_Invulnerable = deidrich, false
Act_ActTrig = deidrich_extra_defence02


;

[Trigger]
nickname = deidrich_extra_defence02
Cnd_HealthDec = deidrich, 0.6
Act_LightFuse = deidrich, fuse_m03_deidrich_extra_shield02
Act_Invulnerable = deidrich, true
Act_ActTrig = deidrich_extra_defence02_turn_off

[Trigger]
nickname = deidrich_extra_defence02_turn_off
Cnd_Timer = 10
Act_LightFuse = deidrich, fuse_m03_deidrich_extra_shield02_turn_off
Act_Invulnerable = deidrich, false
Act_ActTrig = deidrich_extra_defence03

;

[Trigger]
nickname = deidrich_extra_defence03
Cnd_HealthDec = deidrich, 0.3
Act_LightFuse = deidrich, fuse_m03_deidrich_extra_shield03
Act_Invulnerable = deidrich, true
Act_ActTrig = deidrich_extra_defence03_turn_off

[Trigger]
nickname = deidrich_extra_defence03_turn_off
Cnd_Timer = 10
Act_LightFuse = deidrich, fuse_m03_deidrich_extra_shield03_turn_off
Act_Invulnerable = deidrich, false

;

[Trigger]
nickname = deidrich_destroyed
Cnd_Destroyed = deidrich
Act_ActTrig = Destroy_KGB

[Trigger]
nickname = Destroy_KGB
Cnd_Timer = 3
Act_ActTrig = prepare_fleet_to_epic
Act_ActTrig = hide_evil_fighters
Act_ActTrig = ms3_fp7_epic_death
Act_PlayMusic = none, none, none, music_friendly_encouragement
Act_GiveObjList = Player, force_stop
Act_GiveObjList = Player, punishers_follow_player

[Trigger]
nickname = hide_fleet_fighters
Cnd_True = no_params
{{ wilham.hide_all() }}
{{ fleet_fighter.hide_all() }}
{{ last_defence.hide_all() }}
{{ escaper1.hide_all() }}
{{ escaper2.hide_all() }}
{{ escaper3.hide_all() }}
{{ escaper4.hide_all() }}

[Trigger]
nickname = hide_evil_fighters
Cnd_True = no_params
{{ evil_freighter.hide_all() }}
{{ evil_fighter.hide_all() }}

[Trigger]
nickname = prepare_fleet_to_epic
Cnd_True = no_params
Act_RelocateShip = gunship_1, {{ gb1_attack.pos_orient }}
Act_RelocateShip = gunship_2, {{ gb2_attack.pos_orient }}
Act_RelocateShip = gunship_3, {{ gb3_attack.pos_orient }}
Act_RelocateShip = gunship_4, {{ gb4_attack.pos_orient }}
Act_RelocateShip = cruiser_1, {{ cr1_attack.pos_orient }}
Act_RelocateShip = cruiser_2, {{ cr2_attack.pos_orient }}
Act_RelocateShip = battleship_1, {{ bsh_attack.pos_orient }}

[Trigger]
nickname = ms3_fp7_epic_death
Cnd_true = no_params
Act_CallThorn = scripts\mod\m03_kgb_death01.thn, Player
Act_LightFuse = {{ dock1.name }}, freeport7_main_fuse1
Act_LightFuse = {{ dock2.name }}, freeport7_main_fuse1

Act_ActTrig = ms3_fp_epic_death_destroy_shields_fx

[Trigger]
nickname = ms3_fp_epic_death_destroy_shields_fx
Cnd_Timer = 8
Act_LightFuse = {{ kgb.name }}, fuse_kgb
Act_CallThorn = scripts\mod\m03_kgb_death02.thn, Player
Act_ActTrig = ms3_fp_epic_death_final_accord

[Trigger]
nickname = ms3_fp_epic_death_final_accord
Cnd_Timer = 8
Act_Destroy = {{ dock1.name }}, EXPLODE
Act_Destroy = {{ dock2.name }}, EXPLODE
Act_ActTrig = ms3_fp_epic_death_final_cam

[Trigger]
nickname = ms3_fp_epic_death_final_cam
Cnd_Timer = 2

Act_ActTrig = ms3_fp_epic_death_stop_cam

[Trigger]
nickname = ms3_fp_epic_death_stop_cam
Cnd_Timer = 8
Act_RevertCam = no_params
Act_Invulnerable = Player, false
Act_ActTrig = KGB_DESTROING_COMPLETE

;-------------------------------

[Trigger]
nickname = KGB_DESTROING_COMPLETE
Cnd_Timer = 1
;Reichman: KGB destroyed. What with Deidrich?
Act_EtherComm = echo_m03, 093530, Player, DX_M03_0270_reichman, -1, rh_reichman_head, rh_reichman_body, prop_neuralnet_A_right

;Hassler: Is destroyed. But freighter is escaped
Act_EtherComm = echo_m03, 093531, Player, DX_M03_0280_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman

;Reichman: Find and destroy Freighter!
Act_EtherComm = echo_m03, 093534, Player, DX_M03_0290_reichman, -1, rh_reichman_head, rh_reichman_body, prop_neuralnet_A_right

Act_ActTrig = init_TRADEPOINT

[Trigger]
nickname = init_TRADEPOINT
Cnd_CommComplete = DX_M03_0290_reichman
{{ nn_goto_freighter.set() }}
;Hassler: Ok
Act_EtherComm = echo_m03, 093535, Player, DX_M03_0300_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman

Act_ActTrig = around_TRADEPOINT
Act_PlayMusic = no_params


[Trigger]
nickname = around_TRADEPOINT
Cnd_DistVec = inside, Player, {{ tradepoint.pos }}, 1000
Act_GiveObjList = Player, force_stop
;Punisher: We found the jumpgate
Act_EtherComm = echo_m03, 093577, Player, DX_M03_1180_punisher, -1,  rh_sales_head, rh_male_elite_body, comm_rh_elite

Act_ActTrig = init_LAST_JUMPGATE

[Trigger]
nickname = init_LAST_JUMPGATE
Cnd_CommComplete = DX_M03_1180_punisher
{{ nn_kgb_to_rh_mnh_fly.set() }}
Act_ActTrig = around_LAST_JUMPGATE

;Hassler: We have one last chance
Act_EtherComm = echo_m03, 093578, Player, DX_M03_1190_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman


[Trigger]
nickname = around_LAST_JUMPGATE
Cnd_DistShip = inside, Player, {{ kgb_to_rh_mnh.name }}, 2000
Act_LockDock = Player, {{ kgb_to_rh_mnh.name }}, unlock
{{ nn_kgb_to_rh_mnh.set() }}
Act_RandomPop = false
Act_ActTrig = welcome_to_mnh

[Trigger]
nickname = welcome_to_mnh
Cnd_NPCSystemEnter = rh_mnh, {{ hassler.member() }}, {{ punisher.member(1) }}, Player
Act_RandomPop = false
{{ nag.nag_off() }}
Act_LockDock = Player, {{ kgb_to_rh_mnh.name }}, lock
Act_ActTrig = mnh_welcome_wait_complete

[Trigger]
nickname = mnh_welcome_wait_complete
Cnd_Timer = 1
Act_ActTrig = munchen_dialog
{{ nag.nag_voice }}
Act_GiveObjList = Player, punishers_follow_player

[Trigger]
nickname = munchen_dialog
Cnd_True = no_params
;Player: We lost them
Act_EtherComm = echo_m03_player, 093536, Player, DX_M03_0310_trent, -1, pi_pirate5_head, player_body, player_commhelmet

Act_ActTrig = init_ASTDOCK

[Trigger]
nickname = init_ASTDOCK
Cnd_CommComplete = DX_M03_0310_trent
;Hassler: i don't know. go to nearest base
Act_EtherComm = echo_m03, 093537, Player, DX_M03_0320_hassler, -1, rh_hassler_head, rh_male_elite_body, comm_rh_reichman

{{ nn_final_base_fly.set() }}
Act_ActTrig = ASTDOCK_CLOSE
Act_ActTrig = on_ASTBASE

[Trigger]
nickname = ASTDOCK_CLOSE
Cnd_DistShip = inside, Player, rh_mnh_03, 1500
Act_PlayMusic = music_omega_space, music_omega_danger, music_omega_battle, music_victory, 1, true

Act_GiveObjList = Player, force_stop
{{ nn_final_base.set() }}
{{ final_base.make_neutral }}
Act_ActTrig = remove_punishers_formation

[Trigger]
nickname = on_ASTBASE
Cnd_BaseEnter = {{ final_base.base }}
Act_AddRTC = missions\m03\team_msn.ini
Act_NagOff = astdock
Act_ActTrig = loc_enter_Deck
repeatable = true

[Trigger]
nickname = loc_enter_Deck
Cnd_LocEnter = Deck, {{ final_base.base }}
Act_AdjAcct = 7500
Act_ActTrig = MSN_REP_AFTER
Act_ChangeState = SUCCEED


[Trigger]
nickname = MSN_REP_BEFORE
Cnd_True = no_params
Act_SetRep = Player, co_grp, -0.9
Act_ActTrig = REP_HOTFIX

[Trigger]
nickname = MSN_REP_AFTER
Cnd_True = no_params
Act_SetRep = Player, rx_grp, -0.3
Act_SetRep = Player, pi_grp, -0.3
Act_SetRep = Player, edv_grp, 0
Act_ActTrig = REP_HOTFIX

[Trigger]
nickname = REP_HOTFIX
Cnd_True = no_params
Act_SetRep = Player, fc_lr_grp, -0.8
Act_SetVibeOfferBaseHack = {{ final_base.name }}
